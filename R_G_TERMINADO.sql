-- CREATE TABLE ADMINISTRADOR

CREATE TABLE ADMINISTRADOR(
	ADMI_CEDULA INTEGER PRIMARY KEY,
	ADMI_NOMBRE VARCHAR (50),
	ADMI_APELLIDO VARCHAR (50)
);
INSERT INTO ADMINISTRADOR(ADMI_CEDULA , ADMI_NOMBRE, ADMI_APELLIDO ) VALUES
(1315698526, 'JUAN' , ' GARCIA DELGADO ');
INSERT INTO ADMINISTRADOR(ADMI_CEDULA , ADMI_NOMBRE, ADMI_APELLIDO ) VALUES
(1384649337, 'MARCOS' , ' CEDEÑO ZAMBRANO ');
INSERT INTO ADMINISTRADOR(ADMI_CEDULA , ADMI_NOMBRE, ADMI_APELLIDO ) VALUES
(1386957528, 'LUCIA' , ' VELEZ ZAMBRANO');
INSERT INTO ADMINISTRADOR(ADMI_CEDULA , ADMI_NOMBRE, ADMI_APELLIDO ) VALUES
(1388288455, 'CARMEN' , ' ZAMBRANO SANTANA');

--SELECT * FROM ADMINISTRADOR;

-- CREATE TABLE AREA_REGISTRO

CREATE TABLE AREA_REGISTRO(
	TIPO_CODIGO INTEGER PRIMARY KEY,
	TIPO_DETALLE VARCHAR (45),
	ADMI_CEDULA INTEGER,
	CONSTRAINT ADMI_CEDULA FOREIGN KEY (ADMI_CEDULA)
	REFERENCES ADMINISTRADOR(ADMI_CEDULA) ON UPDATE CASCADE
);

INSERT INTO AREA_REGISTRO (TIPO_CODIGO , TIPO_DETALLE, ADMI_CEDULA) VALUES
(0001, 'NACIMIENTO', 1315698526);
INSERT INTO AREA_REGISTRO (TIPO_CODIGO , TIPO_DETALLE, ADMI_CEDULA) VALUES
(0002, 'MATRIMONIO' , 1384649337);
INSERT INTO AREA_REGISTRO (TIPO_CODIGO , TIPO_DETALLE, ADMI_CEDULA) VALUES
(0003,'DEFUNCIONES' , 1388288455);
INSERT INTO AREA_REGISTRO (TIPO_CODIGO , TIPO_DETALLE, ADMI_CEDULA) VALUES
(0004,'REPRESENTACIONES LEGALES' , 1386957528);

--SELECT * FROM AREA_REGISTRO

-- CREATE TABLE DETALLE_AREA

CREATE TABLE DETALLE_AREA(
	DET_CODIGO INTEGER PRIMARY KEY,
	DET_DESCRIPCION VARCHAR (45),
	TIPO_CODIGO INTEGER,
	CONSTRAINT TIPO_CODIGO FOREIGN KEY (TIPO_CODIGO)
	REFERENCES AREA_REGISTRO(TIPO_CODIGO) ON UPDATE CASCADE
);

INSERT INTO DETALLE_AREA (DET_CODIGO , DET_DESCRIPCION, TIPO_CODIGO) VALUES
(00102, 'REGISTRO DE ABORTOS', 0001);
INSERT INTO DETALLE_AREA (DET_CODIGO , DET_DESCRIPCION, TIPO_CODIGO) VALUES
(00109, 'REGISTRO DE FILIACION', 0001);
INSERT INTO DETALLE_AREA (DET_CODIGO , DET_DESCRIPCION,TIPO_CODIGO) VALUES
(00111,'REGISTRO DE NOMBRES', 0001);
INSERT INTO DETALLE_AREA (DET_CODIGO , DET_DESCRIPCION,  TIPO_CODIGO) VALUES
(00115, 'REGISTRO DE NACIONALIDAD', 0001);
INSERT INTO DETALLE_AREA (DET_CODIGO , DET_DESCRIPCION,  TIPO_CODIGO) VALUES
(00117, 'REGISTRO DE DIVORCIOS', 0002);
INSERT INTO DETALLE_AREA (DET_CODIGO , DET_DESCRIPCION, TIPO_CODIGO) VALUES
(00119,'REGISTRO DE MATRIMONIOS', 0002);
INSERT INTO DETALLE_AREA (DET_CODIGO , DET_DESCRIPCION, TIPO_CODIGO) VALUES
(00120, 'REGISTRO DE DEFUNCIONES NATURALES', 0003);
INSERT INTO DETALLE_AREA (DET_CODIGO , DET_DESCRIPCION, TIPO_CODIGO) VALUES
(00125,'REGISTRO DE DEFUNCIONES ACCIDENTE', 0003);
INSERT INTO DETALLE_AREA (DET_CODIGO , DET_DESCRIPCION, TIPO_CODIGO) VALUES
(00126,'REGISTRO DE DEFUNCIONES SUICIDIO', 0003);
INSERT INTO DETALLE_AREA (DET_CODIGO , DET_DESCRIPCION, TIPO_CODIGO) VALUES
(00127,'REGISTRO DE DEFUNCIONES HOMICIDIO', 0003);
INSERT INTO DETALLE_AREA (DET_CODIGO , DET_DESCRIPCION, TIPO_CODIGO) VALUES
(00129,'REGISTRO DE DEFUNCIONES INDETERMINADO', 0003);
INSERT INTO DETALLE_AREA (DET_CODIGO , DET_DESCRIPCION, TIPO_CODIGO) VALUES
(00130,'REGISTRO DE DEFUNCIONES PENDIENTE', 0003);
INSERT INTO DETALLE_AREA (DET_CODIGO , DET_DESCRIPCION, TIPO_CODIGO) VALUES
(00134,'REGISTRO DE SOCIEDADES CIVILES', 0004);

--SELECT * FROM DETALLE_AREA

-- CREATE TABLE USUARIO

CREATE TABLE USUARIO(
	USU_CEDULA INTEGER PRIMARY KEY,
	USU_NOMBRE VARCHAR (45),
	USU_APELLIDO VARCHAR (45),
	USU_DIRECCION VARCHAR (45),
	USU_CELULAR INTEGER,
	TIPO_CODIGO INTEGER,
	CONSTRAINT TIPO_CODIGO FOREIGN KEY (TIPO_CODIGO)
	REFERENCES AREA_REGISTRO(TIPO_CODIGO) ON UPDATE CASCADE
);

INSERT INTO USUARIO (USU_CEDULA , USU_NOMBRE, USU_APELLIDO, USU_DIRECCION, USU_CELULAR, TIPO_CODIGO) VALUES
(1352498953, 'MARIANA', 'ZAMBRANO CEDEÑO','DIVINO NIÑO', 0954863215, 0002);
INSERT INTO USUARIO (USU_CEDULA , USU_NOMBRE, USU_APELLIDO, USU_DIRECCION, USU_CELULAR, TIPO_CODIGO) VALUES
(1375523658, 'CARMEN','VELEZ MENDOZA','LOS ESTEROS', 0986541224, 0004);
INSERT INTO USUARIO (USU_CEDULA , USU_NOMBRE, USU_APELLIDO, USU_DIRECCION, USU_CELULAR, TIPO_CODIGO) VALUES
(1316858057,'CARLOS', 'BRIONES PICO','MARBELLA', 0943287436, 0003);
INSERT INTO USUARIO (USU_CEDULA , USU_NOMBRE, USU_APELLIDO, USU_DIRECCION, USU_CELULAR, TIPO_CODIGO) VALUES
(1314833392, 'SANDRE', 'ZAMBRANO ESPINAL','DIVINO NIÑO', 09467836, 0001);
INSERT INTO USUARIO (USU_CEDULA , USU_NOMBRE, USU_APELLIDO, USU_DIRECCION, USU_CELULAR, TIPO_CODIGO) VALUES
(0912346539, 'MATEO','LUCAS MENDOZA','LA PRADERA', 0976200008, 0004);
INSERT INTO USUARIO (USU_CEDULA , USU_NOMBRE, USU_APELLIDO, USU_DIRECCION, USU_CELULAR, TIPO_CODIGO) VALUES
(1314811629,'IVAN', 'PICO PARRALES','ALTAMIRA', 0941239809, 0003);
INSERT INTO USUARIO (USU_CEDULA , USU_NOMBRE, USU_APELLIDO, USU_DIRECCION, USU_CELULAR, TIPO_CODIGO) VALUES
(1359884585,'CAMILA', 'DELGADO SANDOVAL','COSTA AZUL ', 095221135, 0002);
INSERT INTO USUARIO (USU_CEDULA , USU_NOMBRE, USU_APELLIDO, USU_DIRECCION, USU_CELULAR, TIPO_CODIGO) VALUES
(1358886224,'IVANA', 'LUCAS MENDOZA','DIVINO NIÑO', 0952125553, 0002);

--SELECT * FROM USUARIO

-- CREATE TABLE ESTADO_REGISTRO

CREATE TABLE ESTADO_REGISTRO(
	EST_CODIGO INTEGER PRIMARY KEY,
	EST_DETALLE VARCHAR (45),
	DET_CODIGO INTEGER,
	CONSTRAINT DET_CODIGO FOREIGN KEY (DET_CODIGO)
	REFERENCES DETALLE_AREA(DET_CODIGO) ON UPDATE CASCADE
);

INSERT INTO ESTADO_REGISTRO (EST_CODIGO , EST_DETALLE, DET_CODIGO) VALUES
(10001, 'SOLICITUD',00117);
INSERT INTO ESTADO_REGISTRO (EST_CODIGO , EST_DETALLE, DET_CODIGO) VALUES
(10002, 'TRAMITE',00130);
INSERT INTO ESTADO_REGISTRO (EST_CODIGO , EST_DETALLE, DET_CODIGO) VALUES
(10003, 'NOTIFICACION',00125);
INSERT INTO ESTADO_REGISTRO (EST_CODIGO , EST_DETALLE, DET_CODIGO) VALUES
(10004, 'REALIZADO',00111);

--SELECT * FROM ESTADO_REGISTRO

-- CREATE TABLE VISITA

CREATE TABLE VISITA(
	VIS_CODIGO INTEGER PRIMARY KEY,
	VIS_FECHA DATE,
	USU_CEDULA INTEGER,
	EST_CODIGO INTEGER,
	CONSTRAINT USU_CEDULA FOREIGN KEY (USU_CEDULA)
	REFERENCES USUARIO(USU_CEDULA) ON UPDATE CASCADE,
	CONSTRAINT EST_CODIGO  FOREIGN KEY (EST_CODIGO )
	REFERENCES ESTADO_REGISTRO(EST_CODIGO ) ON UPDATE CASCADE
);

INSERT INTO VISITA (VIS_CODIGO , VIS_FECHA, USU_CEDULA, EST_CODIGO) VALUES
(1001, '19/01/2021', 1352498953, 10001 );
INSERT INTO VISITA (VIS_CODIGO , VIS_FECHA, USU_CEDULA, EST_CODIGO) VALUES
(1002, '21/01/2021', 1375523658, 10002 );
INSERT INTO VISITA (VIS_CODIGO , VIS_FECHA, USU_CEDULA, EST_CODIGO) VALUES
(1003, '24/01/2021', 1316858057, 10003 );
INSERT INTO VISITA (VIS_CODIGO , VIS_FECHA, USU_CEDULA, EST_CODIGO) VALUES
(1004, '26/01/2021', 1314833392, 10002 );
INSERT INTO VISITA (VIS_CODIGO , VIS_FECHA, USU_CEDULA, EST_CODIGO) VALUES
(1005, '28/01/2021', 0912346539, 10001 );
INSERT INTO VISITA (VIS_CODIGO , VIS_FECHA, USU_CEDULA, EST_CODIGO) VALUES
(1006, '30/01/2021', 1314811629, 10004 );
INSERT INTO VISITA (VIS_CODIGO , VIS_FECHA, USU_CEDULA, EST_CODIGO) VALUES
(1007, '04/02/2021',1359884585, 10001 );
INSERT INTO VISITA (VIS_CODIGO , VIS_FECHA, USU_CEDULA, EST_CODIGO) VALUES
(1008, '01/02/2021', 1358886224, 10004 );

--SELECT * FROM VISITA 

-- CREATE TABLE CONYUGUE

CREATE TABLE CONYUGUE(
	CON_CODIGO VARCHAR (3) PRIMARY KEY,
	CON_NOMBRE VARCHAR(50),
	CON_APELLIDO VARCHAR(50),
	CON_SUELDO FLOAT	
);

INSERT INTO CONYUGUE (CON_CODIGO , CON_NOMBRE, CON_APELLIDO, CON_SUELDO) VALUES
('001', 'CARLOS', 'CEDEÑO ALCIVAR', 400.00 );
INSERT INTO CONYUGUE (CON_CODIGO , CON_NOMBRE, CON_APELLIDO, CON_SUELDO) VALUES
('002', 'JOSE', 'ARTEAGA DELGADO', 396.50 );
INSERT INTO CONYUGUE (CON_CODIGO , CON_NOMBRE, CON_APELLIDO, CON_SUELDO) VALUES
('003', 'ANTONIO', 'GARCIA SANDOVAL',895.78 );

--SELECT * FROM CONYUGUE

-- CREATE TABLE HIJO

CREATE TABLE HIJO(
	HIJO_CODIGO INTEGER PRIMARY KEY,
	HIJO_NOMBRE VARCHAR (45),
	HIJO_APELLIDO VARCHAR (45),
	HIJO_EDAD INTEGER,
	USU_CEDULA INTEGER,
	CON_CODIGO VARCHAR (3),
	CONSTRAINT USU_CEDULA FOREIGN KEY (USU_CEDULA)
	REFERENCES USUARIO(USU_CEDULA) ON UPDATE CASCADE,
	CONSTRAINT CON_CODIGO FOREIGN KEY (CON_CODIGO)
	REFERENCES CONYUGUE(CON_CODIGO) ON UPDATE CASCADE
);

INSERT INTO HIJO (HIJO_CODIGO , HIJO_NOMBRE, HIJO_APELLIDO, HIJO_EDAD, USU_CEDULA, CON_CODIGO) VALUES
(1, 'INES', 'CEDEÑO ZAMBRANO',2,1352498953, '001');
INSERT INTO HIJO (HIJO_CODIGO ,  HIJO_NOMBRE, HIJO_APELLIDO, HIJO_EDAD, USU_CEDULA, CON_CODIGO) VALUES
(2, 'CAMILA', 'ARTEAGA DELGADO',7, 1359884585, '002');
INSERT INTO HIJO (HIJO_CODIGO , HIJO_NOMBRE, HIJO_APELLIDO, HIJO_EDAD, USU_CEDULA, CON_CODIGO) VALUES
(3, 'SALOME', 'GARCIA LUCAS ',5, 1358886224, '003');
INSERT INTO HIJO (HIJO_CODIGO , HIJO_NOMBRE, HIJO_APELLIDO, HIJO_EDAD, USU_CEDULA, CON_CODIGO) VALUES
(4, 'GEOVANY', 'GARCIA LUCAS ',15, 1358886224, '003');

--SELECT * FROM HIJO

-- CREATE TABLE PEDIDO_DIVORCIO

CREATE TABLE PEDIDO_DIVORCIO(
	DIV_CODIGO VARCHAR (3) PRIMARY KEY,
	DIV_DATE DATE,
	DIV_PENSION FLOAT,
	DIV_REGIMEN_VISITA VARCHAR (50),
	USU_CEDULA INTEGER,
	CONSTRAINT USU_CEDULA FOREIGN KEY (USU_CEDULA)
	REFERENCES USUARIO(USU_CEDULA) ON UPDATE CASCADE
);

INSERT INTO PEDIDO_DIVORCIO (DIV_CODIGO , DIV_DATE, DIV_REGIMEN_VISITA,  USU_CEDULA) VALUES
('001', '10/01/2021',' LUNES, MIERCOLES, VIERNES',1352498953);
INSERT INTO PEDIDO_DIVORCIO (DIV_CODIGO , DIV_DATE, DIV_REGIMEN_VISITA, USU_CEDULA) VALUES
('002', '16/01/2021','DOMINGOS',1359884585 );
INSERT INTO PEDIDO_DIVORCIO (DIV_CODIGO , DIV_DATE, DIV_REGIMEN_VISITA, USU_CEDULA) VALUES
('003', '18/01/2021','FINES DE SEMANA',1358886224);

-- SELECT * FROM PEDIDO_DIVORCIO

-- CREATE TABLE EMPLEADO

CREATE TABLE EMPLEADO(
	EMP_CEDULA INTEGER PRIMARY KEY,
	EMP_NOMBRE VARCHAR (45),
	EMP_APELLIDO VARCHAR (45),
	EMP_EMAIL VARCHAR (45),
	EMP_DIRECCION VARCHAR (45),
	EMP_CELULAR INTEGER,
	TIPO_CODIGO INTEGER,
	DET_CODIGO INTEGER,
	CONSTRAINT TIPO_CODIGO FOREIGN KEY (TIPO_CODIGO)
	REFERENCES AREA_REGISTRO(TIPO_CODIGO) ON UPDATE CASCADE,
	CONSTRAINT DET_CODIGO FOREIGN KEY (DET_CODIGO)
	REFERENCES DETALLE_AREA(DET_CODIGO) ON UPDATE CASCADE
);
INSERT INTO EMPLEADO (EMP_CEDULA , EMP_NOMBRE, EMP_APELLIDO, EMP_EMAIL, EMP_DIRECCION, EMP_CELULAR, TIPO_CODIGO, DET_CODIGO) VALUES
(1379856522, 'ELVA', 'PICO QUIROZ','elvapq@gmail.com','SECTOR LOS ESTEROS', 0946875221, 0001,00102);
INSERT INTO EMPLEADO (EMP_CEDULA, EMP_NOMBRE, EMP_APELLIDO, EMP_EMAIL, EMP_DIRECCION, EMP_CELULAR, TIPO_CODIGO , DET_CODIGO) VALUES
(1387462595, 'ELVIS','MOLINA PEREZ','elvismp@gmail.com','CUBA', 0987775612, 0001,00109 );
INSERT INTO EMPLEADO (EMP_CEDULA , EMP_NOMBRE, EMP_APELLIDO, EMP_EMAIL, EMP_DIRECCION, EMP_CELULAR, TIPO_CODIGO, DET_CODIGO) VALUES
(1376556899, 'VICTORIA', 'DELGADO GRACIA','vickicita@gmail.com','DIVINO NIÑO', 0985654423, 0002,00117);
INSERT INTO EMPLEADO (EMP_CEDULA , EMP_NOMBRE, EMP_APELLIDO, EMP_EMAIL, EMP_DIRECCION, EMP_CELULAR, TIPO_CODIGO, DET_CODIGO) VALUES
(1368752521, 'JACQUELINE', 'SANTANA MENDOZA','JACQ@gmail.com','SANTA MARTHA', 0953215844, 0002,00119);
INSERT INTO EMPLEADO (EMP_CEDULA , EMP_NOMBRE, EMP_APELLIDO, EMP_EMAIL, EMP_DIRECCION, EMP_CELULAR, TIPO_CODIGO, DET_CODIGO) VALUES
(1307638910, 'ALMA', ' HERNANDEZ MONTERROZA','hernandez18al@gmail.com',' MIRAFLORES', 0985321258, 0003,00120);
INSERT INTO EMPLEADO (EMP_CEDULA, EMP_NOMBRE, EMP_APELLIDO, EMP_EMAIL, EMP_DIRECCION, EMP_CELULAR, TIPO_CODIGO, DET_CODIGO) VALUES
(1351309202, ' ALEJANDRO',' ACERO CARO','ale_caro@gmail.com','EL CARMEN', 0987532115, 0003,00125);
INSERT INTO EMPLEADO (EMP_CEDULA , EMP_NOMBRE, EMP_APELLIDO, EMP_EMAIL, EMP_DIRECCION, EMP_CELULAR, TIPO_CODIGO, DET_CODIGO) VALUES
(1306022012, 'VICTOR', ' RODRÍGUEZ BOTERO','victorrodriguez@gmail.com','SAN JUAN', 0954782203, 0003,00127);
INSERT INTO EMPLEADO (EMP_CEDULA , EMP_NOMBRE, EMP_APELLIDO, EMP_EMAIL, EMP_DIRECCION, EMP_CELULAR, TIPO_CODIGO, DET_CODIGO) VALUES
(1395224589, ' CAMILO', 'DIAZ BELTRAN','camilo@gmail.com','SANTA CLARA', 0985245325, 0004,00134);
INSERT INTO EMPLEADO (EMP_CEDULA , EMP_NOMBRE, EMP_APELLIDO, EMP_EMAIL, EMP_DIRECCION, EMP_CELULAR, TIPO_CODIGO, DET_CODIGO) VALUES
(1357611258, ' SEBASTIAN', 'ALCIVAR DELGADO','sebas_alci@gmail.com','CIELITO LINDO', 0985665241, 0003,00129);
INSERT INTO EMPLEADO (EMP_CEDULA , EMP_NOMBRE, EMP_APELLIDO, EMP_EMAIL, EMP_DIRECCION, EMP_CELULAR, TIPO_CODIGO, DET_CODIGO) VALUES
(1388751258, ' JHON', 'SANTANA CEVALLOS','jhon_cevallos@gmail.com','LOS ALGARROBOS', 0987565556, 0003,00130);

--SELECT * FROM EMPLEADO

--CONSULTA #1
---Mostrar cuantos divorcios se realizaron durante el año.

SELECT  
  detalle_area.det_descripcion,
  count (detalle_area.det_descripcion) as divorcios
FROM public.usuario
  INNER JOIN public.area_registro ON usuario.tipo_codigo = area_registro.tipo_codigo 
  INNER JOIN  public.visita ON usuario.usu_cedula = visita.usu_cedula 
  INNER JOIN public.detalle_area ON detalle_area.tipo_codigo = area_registro.tipo_codigo
WHERE 
 detalle_area.det_codigo='00117' AND visita.vis_fecha >='01/01/2021' AND visita.vis_fecha <'01/01/2022'
GROUP BY 
   detalle_area.det_descripcion   

--CONSULTA #2
---Mostrar el total de hijos que tiene cada una de las parejas las cuales se divorcian en el 
--cual incluya los nombres completos de los padres , el régimen de visita y la fecha en la cual se realiza el tramite

SELECT 
  (usuario.usu_nombre || ' ' || usuario.usu_apellido) AS USUARIO,
  (conyugue.con_nombre || ' ' || conyugue.con_apellido) AS CONYUGUE,
  count (hijo.hijo_nombre || ' ' || hijo.hijo_apellido) AS HIJOS, 
  pedido_divorcio.div_regimen_visita,
  pedido_divorcio.div_date,
  detalle_area.det_descripcion
FROM 
  public.pedido_divorcio
  INNER JOIN public.usuario ON pedido_divorcio.usu_cedula = usuario.usu_cedula
  INNER JOIN public.hijo ON hijo.usu_cedula = usuario.usu_cedula
  INNER JOIN public.conyugue ON  hijo.con_codigo = conyugue.con_codigo
  INNER JOIN public.area_registro ON area_registro.tipo_codigo = usuario.tipo_codigo
  INNER JOIN public.detalle_area ON  area_registro.tipo_codigo = detalle_area.tipo_codigo
WHERE
  detalle_area.det_codigo = 00117
GROUP BY 
   usuario.usu_nombre,
   usuario.usu_apellido, 
   conyugue.con_nombre,
   conyugue.con_apellido,
   hijo.hijo_apellido, 
   pedido_divorcio.div_date, 
   pedido_divorcio.div_regimen_visita,
   detalle_area.det_descripcion

--CONSULTA #3
--Mostrar a un administrador de un área específica con los correspondientes empleados que administra.

SELECT
  (administrador.admi_nombre || ' ' || administrador.admi_apellido) AS ADMINISTRADOR,
  (empleado.emp_nombre || ' ' || empleado.emp_apellido) AS EMPLEADOS,
  area_registro.tipo_detalle,
  detalle_area.det_descripcion
FROM   
  public.area_registro
  INNER JOIN public.administrador ON administrador.admi_cedula = area_registro.admi_cedula
  INNER JOIN public.empleado ON empleado.tipo_codigo = area_registro.tipo_codigo 
  INNER JOIN public.detalle_area ON detalle_area.tipo_codigo = area_registro.tipo_codigo 
WHERE 
  area_registro.tipo_codigo=0003 AND 
  detalle_area.det_descripcion='REGISTRO DE DEFUNCIONES HOMICIDIO'

--CONSULTA #4
--Mostrar el saldo de la pensión de cada uno de los niños de los cuales los 
--padres se han separado con la edad del niño y la fecha en la que se realiza el tramite 

-- Pension de los hijos mayoresde 10 años y menores que 24
SELECT 
  pedido_divorcio.div_date, 
  hijo.hijo_nombre, 
  hijo.hijo_apellido, 
  hijo.hijo_edad, 
  conyugue.con_sueldo,
  (conyugue.con_sueldo*0.40) as PENSION
FROM public.usuario
  INNER JOIN public.pedido_divorcio ON pedido_divorcio.usu_cedula = usuario.usu_cedula
  INNER JOIN public.hijo ON hijo.usu_cedula = usuario.usu_cedula 
  INNER JOIN public.conyugue ON hijo.con_codigo = conyugue.con_codigo
WHERE  
 hijo.hijo_edad >10 AND hijo.hijo_edad <24

-- Pension de los hijos menores de 10 años

SELECT 
  pedido_divorcio.div_date, 
  hijo.hijo_nombre, 
  hijo.hijo_apellido, 
  hijo.hijo_edad, 
  conyugue.con_sueldo,
  (conyugue.con_sueldo*0.30) as PENSION
FROM public.usuario
  INNER JOIN public.pedido_divorcio ON pedido_divorcio.usu_cedula = usuario.usu_cedula
  INNER JOIN public.hijo ON hijo.usu_cedula = usuario.usu_cedula 
  INNER JOIN public.conyugue ON hijo.con_codigo = conyugue.con_codigo
WHERE  
 hijo.hijo_edad <10 

--Consulta #5

--Mostrar el total de las areas mayores de las cuales acudieron los usuarios 
--incluyendo el detalle del área a la cual acudió el usuario  

SELECT 
  area_registro.tipo_detalle, 
  detalle_area.det_descripcion,
  COUNT(detalle_area.det_descripcion) AS AREAS
FROM public.area_registro
 INNER JOIN public.detalle_area ON area_registro.tipo_codigo = detalle_area.tipo_codigo
 INNER JOIN public.usuario ON area_registro.tipo_codigo = usuario.tipo_codigo
 GROUP BY 
 area_registro.tipo_detalle, detalle_area.det_descripcion
  HAVING COUNT (*)>2;

